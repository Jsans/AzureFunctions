#!/usr/bin/env python
# Created by : Jathisan Chandrasegaram

#################################################################################################################
# IMPORTS
#################################################################################################################
import os
import json
from collections import defaultdict
from urllib.parse import urlparse, parse_qs
#################################################################################################################
# Global 
#################################################################################################################
print('test')
#print(os.environ['YOURAPPSETTING'])
#################################################################################################################
# GET : HTTP queries , parse the get url to a dict 
#################################################################################################################
query=os.environ.get('REQ_QUERY')

request_fn=defaultdict(str,code=None)
request_=parse_qs(urlparse(query).query)
request_fn.update(request_)

#################################################################################################################
# FUNCTION
#################################################################################################################
res_json={"some_magic" : "test magic"}

#################################################################################################################
# HTML RESPONSE back from azure functions
#################################################################################################################

returnData = {"status": 200,"body": res_json,"headers": {"Content-Type": "application/json ; charset=utf-8"}}  
output = open(os.environ['res'], 'w')
output.write(json.dumps(returnData))
